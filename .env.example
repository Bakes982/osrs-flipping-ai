# ─── OSRS Flipping AI — Environment Variables ───────────────────────────────
# Copy this file to .env and fill in your values.
# Never commit .env to source control.

# ── MongoDB ──────────────────────────────────────────────────────────────────
MONGODB_URL=mongodb://localhost:27017
DATABASE_NAME=osrs_flipping_ai
REDIS_URL=

# ── URLs (update for production) ─────────────────────────────────────────────
FRONTEND_URL=http://localhost:5173
BACKEND_URL=http://localhost:8001

# ── Discord OAuth2 ───────────────────────────────────────────────────────────
# Create an application at https://discord.com/developers/applications
# Add redirect URI: http://localhost:8001/api/auth/callback
DISCORD_CLIENT_ID=
DISCORD_CLIENT_SECRET=
DISCORD_REDIRECT_URI=http://localhost:8001/api/auth/callback

# ── Auth ─────────────────────────────────────────────────────────────────────
# Random secret for signing session tokens — generate with: python -c "import secrets; print(secrets.token_hex(32))"
AUTH_SECRET=

# Comma-separated Discord user IDs allowed to log in (leave empty to use DB-managed allowlist)
# Find your Discord ID: User Settings → Advanced → Developer Mode → right-click your name → Copy ID
ALLOWED_DISCORD_IDS=

# ── Server ───────────────────────────────────────────────────────────────────
PORT=8001

# Chunk-2 scoring config
VOL_REF_MODE=fixed
VOL_REF_FIXED=0.02
VOL_REF_DAILY_MEDIAN=0.02
TREND_REF=0.01
DECAY_REF=0.25
SPREAD_CV_REF=0.5
LIQ_FREQ_REF_SECONDS=60
LIQ_SPREAD_PCT_REF=0.05
FILL_A0=-0.2
FILL_A1=2.0
FILL_A2=1.2
FILL_A3=1.0
FILL_A4=1.2
FILL_T_MIN=2
FILL_T_MAX=120
MARGIN_REF=50000
ROI_REF=5.0
GPH_REF=10000000
GE_TAX_CAP_ENABLED=false

# Runtime mode
# api    -> serve FastAPI only
# worker -> run background loops only (deploy as separate Railway worker service)
RUN_MODE=api

# Worker resilience / test controls
WORKER_RETRY_INITIAL_SECONDS=2
WORKER_RETRY_MAX_SECONDS=60
WORKER_RUN_ONCE=false
WORKER_RUN_ONCE_SECONDS=0.05

# Flip cache tuning
FLIPS_CACHE_TTL_SECONDS=180
FLIPS_CACHE_WARM_INTERVAL_SECONDS=30
FLIPS_FRESH_MAX_PER_MINUTE=6

# Plugin auth + endpoint rate limits
ALLOW_ANON=false
TOP5_RATE_LIMIT_PER_MINUTE=60
TOP_RATE_LIMIT_PER_MINUTE=20
TOP_REQUIRE_API_KEY=false

# Worker circuit breaker / data quality guardrails
WORKER_CIRCUIT_FAILURE_THRESHOLD=5
WORKER_CIRCUIT_OPEN_SECONDS=300
SCORE_STALE_MAX_MINUTES=45
